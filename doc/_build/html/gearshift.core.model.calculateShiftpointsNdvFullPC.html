

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>gearshift.core.model.calculateShiftpointsNdvFullPC package &mdash; GEARSHIFT TOOL 1.1.2.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> GEARSHIFT TOOL
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#quick-start">Quick-Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html#usage">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Gearshift Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GEARSHIFT TOOL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>gearshift.core.model.calculateShiftpointsNdvFullPC package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/gearshift.core.model.calculateShiftpointsNdvFullPC.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gearshift-core-model-calculateshiftpointsndvfullpc-package">
<h1>gearshift.core.model.calculateShiftpointsNdvFullPC package<a class="headerlink" href="#gearshift-core-model-calculateshiftpointsndvfullpc-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="gearshift.core.model.calculateShiftpointsNdvFullPC.corrections.html">gearshift.core.model.calculateShiftpointsNdvFullPC.corrections package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gearshift.core.model.calculateShiftpointsNdvFullPC.corrections.html#module-gearshift.core.model.calculateShiftpointsNdvFullPC.corrections">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="module-gearshift.core.model.calculateShiftpointsNdvFullPC">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-gearshift.core.model.calculateShiftpointsNdvFullPC" title="Permalink to this headline">¶</a></h2>
<p>It provides GEARSHIFT model <cite>dsp</cite> to obtain the gearshifts following Sub-Annex 2 of the Annex XXI from the
COMMISSION REGULATION (EU) 2017/1151.</p>
<p>Docstrings should provide sufficient understanding for any individual function.</p>
<p>Sub-Modules:</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="gearshift.core.model.calculateShiftpointsNdvFullPC.corrections.html#module-gearshift.core.model.calculateShiftpointsNdvFullPC.corrections" title="gearshift.core.model.calculateShiftpointsNdvFullPC.corrections"><code class="xref py py-obj docutils literal notranslate"><span class="pre">corrections</span></code></a></p></td>
<td><p>It provides the corrections defined in section 4 of the Sub-Annex 2 from Annex XXI from the COMMISSION REGULATION (EU) 2017/1151.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.check_gears">
<code class="sig-name descname"><span class="pre">check_gears</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">NoOfGears</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gear_nbrs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ndv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ExcludeCrawlerGear</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#check_gears"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.check_gears" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if is necessary exclude the first gear from the input gears</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>NoOfGears</strong> (<em>Integer</em>) – Annex 2 (2d) ng. The number of forward gears.</p></li>
<li><p><strong>gear_nbrs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List with of gears of the vehicle.</p></li>
<li><p><strong>Ndv</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – Annex 2 (2e) i ==&gt; (n/v)_i
The ratio obtained by dividing the engine speed n by the vehicle speed v
for each gear i form 1 to ng.</p></li>
<li><p><strong>ExcludeCrawlerGear</strong> (<em>boolean</em>) – Annex 2 (2j)
Gear 1 may be excluded at the request of . the manufacturer if</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>NoOfGearsFinal (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>):</dt><dd><p>The number of forward gears after apply the exclusion of first gear
if is necessary.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Gears (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>):</dt><dd><p>List with of gears of the vehicle after apply the exclusion of first
gear if is necessary.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>NdvRatios (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>The ratio obtained by dividing the engine speed n by the vehicle speed
v for each gear i form 1 to ng after apply the exclusion of first gear
if is necessary.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.parse_speed_trace">
<code class="sig-name descname"><span class="pre">parse_speed_trace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">speed_trace</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#parse_speed_trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.parse_speed_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Split speed trace in trace times and required vehicles speeds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>speed_trace</strong> (<em>array</em>) – Annex 1 (eg 8.3) i ==&gt; v_i
The vehicle speed at second i.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>TraceTimesInput (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Times for each vehicle speed required</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>RequiredVehicleSpeedsInput (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>The vehicle speed required for the whole cycle.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.resample_trace">
<code class="sig-name descname"><span class="pre">resample_trace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TraceTimesInput</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequiredVehicleSpeedsInput</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#resample_trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.resample_trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-sample the trace in 1Hz</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TraceTimesInput</strong> (<em>array</em>) – Times for each vehicle speed required</p></li>
<li><p><strong>RequiredVehicleSpeedsInput</strong> (<em>array</em>) – The vehicle speed required for the whole cycle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>TraceTimes (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Times for each vehicle speed required re-sampled in 1Hz</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>RequiredVehicleSpeeds (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>The vehicle speed required for the whole cycle re-sampled in 1Hz</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>TraceTimesCount (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>):</dt><dd><p>The length of trace times re-sampled in 1Hz</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the trace was provided with higher sample rate, this may lead to data loss.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.identify_phases">
<code class="sig-name descname"><span class="pre">identify_phases</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TraceTimesCount</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequiredVehicleSpeeds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#identify_phases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.identify_phases" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify phases</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TraceTimesCount</strong> (<em>integer</em>) – The length of trace times re-sampled in 1Hz</p></li>
<li><p><strong>RequiredVehicleSpeeds</strong> (<em>array</em>) – The vehicle speed required for the whole cycle re-sampled in 1Hz</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>Phases (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>The list of phases that are used during whole cycle</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>InDecelerationToStandstill (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>The array that contains the seconds from deceleration to standstill as a True</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PhaseValues (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Contains the points of changes phases</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>InStandStill (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>Contains the points that are in standstill phase as a True</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PhaseStarts (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Contains the points that are start point from a phase</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PhaseEnds (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Contains the points that are end point from a phase</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PHASE_ACCELERATION_FROM_STANDSTILL (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>):</dt><dd><p>Acceleration phase following a standstill phase</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PHASE_ACCELERATION (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>):</dt><dd><p>Acceleration phase</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>InAcceleration (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>Contains the points that are in acceleration phase as a True</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>InConstantSpeed (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>Contains the points that are in constant speed phase as a True</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>InAccelerationAnyDuration (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>Some gear corrections ignore the duration of acceleration phases so save acceleration phases
with any duration here.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PHASE_DECELERATION (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>):</dt><dd><dl class="simple">
<dt>Time period of more than 2 seconds with required vehicle:</dt><dd><p>speed &gt;= 1km/h and monotonically decreasing</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PHASE_DECELERATION_TO_STANDSTILL (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>):</dt><dd><p>DECELERATION phase preceding a STANDSTILL phase</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>InDeceleration (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>Contains the points that are in deceleration phase as a True</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PHASE_STANDSTILL (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>):</dt><dd><p>Time period with required vehicle speed &lt; 1km/h</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.load_full_power_curve">
<code class="sig-name descname"><span class="pre">load_full_power_curve</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FullPowerCurve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AdditionalSafetyMargin0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">StartEngineSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EndEngineSpeed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#load_full_power_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.load_full_power_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Load full power curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>FullPowerCurve</strong> (<em>array</em>) – Annex 2 (2h) and (3.4) n ==&gt; P_wot(n), ASM
The full load power curve over the engine speed range.</p></li>
<li><p><strong>AdditionalSafetyMargin0</strong> (<em>array</em>) – This is a legacy parameter used until regulation GRPE-72-10-Rev.2.
Later regulations define the additional safety margin values
as part of the FullPowerCurve.</p></li>
<li><p><strong>StartEngineSpeed</strong> (<em>array</em>) – This is a legacy parameter used until regulation GRPE-72-10-Rev.2.
GRPE-72-10-Rev.2 Annex 2 (3.4) n_start
The engine speed at which ASM approching zero starts.</p></li>
<li><p><strong>EndEngineSpeed</strong> (<em>array</em>) – This is a legacy parameter used until regulation GRPE-72-10-Rev.2.
GRPE-72-10-Rev.2 Annex 2 (3.4) n_end
The engine speed at which ASM approching zero ends.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>PowerCurveEngineSpeeds (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Contains the power curve engine speeds</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PowerCurvePowers (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Contains the power curve powers</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PowerCurveASM (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Contains the power curve additional save margin</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>DefinedPowerCurveAdditionalSafetyMargins (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>):</dt><dd><p>Boolean that define if the additional save margins are present</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function split the different components of full power curve in a independent array</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.determine_rated_engine_power">
<code class="sig-name descname"><span class="pre">determine_rated_engine_power</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RatedEnginePower</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RatedEngineSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurvePowers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurveEngineSpeeds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#determine_rated_engine_power"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.determine_rated_engine_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine rated engine power and rated engine speed from the full power curve</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following requirement was deleted from the regulation but as there is no
new requirement we will stay with the old one :
If the maximum power is developed over an engine speed range, n_rated shall be
the minimum of this range</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RatedEnginePower</strong> (<em>numpy.array</em>) – <p>Annex 2 (2a) P_rated.
This is a legacy parameter used until regulation GRPE-75-23.The maximum rated
engine power as declared by the manufacturer. But the newer regulation
GRPE/2018/2 Annex 2 (2g) now requires : The data sets and the values P_rated
and n_rated shall be taken from the power curve as declared by the manufacturer.</p>
<p>For backward compatibility this parameter may still be used to override the
value calculated from FullPowerCurve. Set RatedEnginePower and RatedEngineSpeed
to 0 to use the calculated values.</p>
</p></li>
<li><p><strong>RatedEngineSpeed</strong> (<em>numpy.array</em>) – <p>Annex 2 (2b) n_rated. This is a legacy parameter used until regulation GRPE-75-23.
The rated engine speed at which an engine declared by the manufacturer as the
engine speed at which the engine develops its maximum power.</p>
<p>But the newer regulation GRPE/2018/2 Annex 2 (2g) now requires: The data sets and
the values P_rated and n_rated shall be taken from the power curve as declared by
the manufacturer.</p>
<p>For backward compatibility this parameter may still be used to override the value
calculated from FullPowerCurve. Set RatedEnginePower and RatedEngineSpeed to 0
to use the calculated values.</p>
</p></li>
<li><p><strong>PowerCurvePowers</strong> (<em>numpy.array</em>) – Contains the power curve powers</p></li>
<li><p><strong>PowerCurveEngineSpeeds</strong> (<em>numpy.array</em>) – Contains the power curve engine speeds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>RatedEnginePowerF (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Contains the rated engine power corrected if is necessary</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>RatedEngineSpeedF (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Contains the rated engine speed corrected if is necessary</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.determine_maximum_engine_speed_95">
<code class="sig-name descname"><span class="pre">determine_maximum_engine_speed_95</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Max95EngineSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurvePowers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurveEngineSpeeds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#determine_maximum_engine_speed_95"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.determine_maximum_engine_speed_95" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the maximum engine speed where 95 percent of the rated power is
reached from the full power curve</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Max95EngineSpeed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2g) n_max1 = n_95_high
The maximum engine speed where 95 per cent of rated power is reached.
If the dummy value 0 will be given for this parameter then n_max1 will
be calculated from parameter FullPowerCurve P_wot.</p></li>
<li><p><strong>PowerCurvePowers</strong> (<em>array</em>) – Contains the power curve powers</p></li>
<li><p><strong>PowerCurveEngineSpeeds</strong> (<em>array</em>) – Contains the power curve engine speeds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>Max95EngineSpeedFinal (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Annex 2 (2g) n_max1 = n_95_high adjusted.
If n_95_high cannot be determined because the engine speed is limited to
a lower value n_lim for all gears and the corresponding full load power
is higher than 95 per cent of rated power, n_95_high shall be set to n_lim.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will only be done if this value was not set as input parameter.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.minimum_engine_speed_in_motion">
<code class="sig-name descname"><span class="pre">minimum_engine_speed_in_motion</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">IdlingEngineSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RatedEngineSpeedF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDriveEngineSpeed1st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDriveEngineSpeed1stTo2nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDriveEngineSpeed2ndDecel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDriveEngineSpeed2nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDriveEngineSpeedGreater2nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TraceTimesCount</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NoOfGearsFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InDecelerationToStandstill</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#minimum_engine_speed_in_motion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.minimum_engine_speed_in_motion" title="Permalink to this definition">¶</a></dt>
<dd><p>Define minimum engine speeds when vehicle is in motion (2k)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>IdlingEngineSpeed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2c) n_idle. The idling speed.</p></li>
<li><p><strong>RatedEngineSpeedF</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Contains the rated engine speed corrected if is necessary</p></li>
<li><p><strong>MinDriveEngineSpeed1st</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – This is a legacy parameter used until regulation GRPE-75-23.
This value may be used to increase the calculated value.
Annex 2 (2k) n_min_drive = n_idle for n_gear:1
The minimum engine speed when the vehicle is in motion.</p></li>
<li><p><strong>MinDriveEngineSpeed1stTo2nd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – This is a legacy parameter used until regulation GRPE-75-23.
This value may be used to increase the calculated value.
Annex 2 (2ka) n_min_drive = 1.15 x n_idle for n_gear:1-&gt;2
The minimum engine speed for transitions from first to second gear.</p></li>
<li><p><strong>MinDriveEngineSpeed2ndDecel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – This is a legacy parameter used until regulation GRPE-75-23.
This value may be used to increase the calculated value.
Annex 2 (2kb) n_min_drive = n_idle for n_gear:2
The minimum engine speed for decelerations to standstill in second gear.</p></li>
<li><p><strong>MinDriveEngineSpeed2nd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – This is a legacy parameter used until regulation GRPE-75-23.
This value may be used to increase the calculated value.
Annex 2 (2kc) n_min_drive = 0.9 x n_idle for n_gear:2</p></li>
<li><p><strong>MinDriveEngineSpeedGreater2nd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – This is a legacy parameter used until regulation GRPE-75-23.
This value may be used to increase the calculated value.
Annex 2 (2k) n_min_drive = n_idle + 0.125 × ( n_rated - n_idle ) for n_gear:3..
This value shall be referred to as n_min_drive_set.
The minimum engine speed for all driving conditions in gears greater than 2.</p></li>
<li><p><strong>TraceTimesCount</strong> (<em>integer</em>) – The length of trace times re-sampled in 1Hz</p></li>
<li><p><strong>NoOfGearsFinal</strong> (<em>integer</em>) – The number of forward gears after apply the exclusion of first gear
if is necessary.</p></li>
<li><p><strong>InDecelerationToStandstill</strong> (<em>boolean array</em>) – The array that contains the seconds from deceleration to standstill as a True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>MinDrivesI (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Minimum engine speeds when vehicle is in motion</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>CalculatedMinDriveEngineSpeedGreater2nd (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>The minimum drive engine speed grater than second</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>MinDrive1stTo2nd (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Annex 2 (2ka) n_min_drive = 1.15 x n_idle for n_gear:1-&gt;2
The minimum engine speed for transitions from first to second gear.
This is the maximum of calculated value and input parameter value.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>MinDrive1st (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Annex 2 (2k) n_min_drive = n_idle for n_gear:1
The minimum engine speed when the vehicle is in motion.
This is the maximum of calculated value and input parameter value.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>MinDrive2ndDecel (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Annex 2 (2kb) n_min_drive = n_idle for n_gear:2
The minimum engine speed for decelerations to standstill in second gear.
This is the maximum of calculated value and input parameter value.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>MinDrive2nd (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Annex 2 (2kc) n_min_drive = 0.9 x n_idle for n_gear:2
The minimum engine speed for all other driving conditions in second gear.
This is the maximum of calculated value and input parameter value.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>MinDriveGreater2nd (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Annex 2 (2k) n_min_drive = n_idle + 0.125 × ( n_rated - n_idle ) for n_gear:3..
This value shall be referred to as n_min_drive_set.
The minimum engine speed for all driving conditions in gears greater than 2.
This is the maximum of calculated value and input parameter value.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The calculation of minimum engine speeds for the second gear does
not fully confirm to the latest legislation text, but rather reflects
the previous revision of it until (2ka) is clarified.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.get_accelerations">
<code class="sig-name descname"><span class="pre">get_accelerations</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RequiredVehicleSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TraceTimes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#get_accelerations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.get_accelerations" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate accelerations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RequiredVehicleSpeeds</strong> (<em>array</em>) – The vehicle speed required for the whole cycle re-sampled in 1Hz</p></li>
<li><p><strong>TraceTimes</strong> (<em>array</em>) – Times for each vehicle speed required re-sampled in 1Hz</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>Accelerations (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>The acceleration required for the whole cycle re-sampled in 1Hz</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.define_minimum_engine_speed_in_motion">
<code class="sig-name descname"><span class="pre">define_minimum_engine_speed_in_motion</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MinDrivesI</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CalculatedMinDriveEngineSpeedGreater2nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDriveEngineSpeedGreater2ndAccel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDriveEngineSpeedGreater2ndDecel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDriveEngineSpeedGreater2ndAccelStartPhase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDriveEngineSpeedGreater2ndDecelStartPhase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequiredVehicleSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TimeEndOfStartPhase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TraceTimes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NoOfGearsFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Accelerations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#define_minimum_engine_speed_in_motion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.define_minimum_engine_speed_in_motion" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the gear, in which the maximum vehicle speed is reached (2i)
The maximum vehicle speed is defined as the vehicle speed, at which the
available power equals the road load power caused by friction and
aerodynamics, and is usually not covered by typical traces. That is why
the calculation is based on sufficient fictive road load speeds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>MinDrivesI</strong> (<em>array</em>) – Minimum engine speeds when vehicle is in motion</p></li>
<li><p><strong>CalculatedMinDriveEngineSpeedGreater2nd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The minimum drive engine speed grater than second</p></li>
<li><p><strong>MinDriveEngineSpeedGreater2ndAccel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2j) n_min_drive_up
Values higher than n_min_drive_set may be used for n_gear &gt; 2.
The manufacturer may specify a value
for acceleration/constant speed phases (n_min_drive_up).</p></li>
<li><p><strong>MinDriveEngineSpeedGreater2ndDecel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2j) n_min_drive_down
Values higher than n_min_drive_set may be used for n_gear &gt; 2.
The manufacturer may specify a value
for deceleration phases (n_min_drive_down).</p></li>
<li><p><strong>MinDriveEngineSpeedGreater2ndAccelStartPhase</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2j) n_min_drive_up_start
Heinz Steven Tool n_min_drive_start_up
For an initial period of time (t_start_phase),
the manufacturer may specify higher values
(n_min_drive_start and/or n_min_drive_up_start)
for the values n_min_drive and/or n_min_drive_up
for n_gear &gt; 2.
This requirement was implemented with other parameters
by the reference implementation Heinz Steven Tool.</p></li>
<li><p><strong>MinDriveEngineSpeedGreater2ndDecelStartPhase</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2j) n_min_drive_start
Heinz Steven Tool n_min_drive_start_down
For an initial period of time (t_start_phase),
the manufacturer may specify higher values
(n_min_drive_start and/or n_min_drive_up_start)
for the values n_min_drive and/or n_min_drive_up
for n_gear &gt; 2.
This requirement was implemented with other parameters
by the reference implementation Heinz Steven Tool.</p></li>
<li><p><strong>RequiredVehicleSpeeds</strong> (<em>numpy.array</em>) – The vehicle speed required for the whole cycle re-sampled in 1Hz</p></li>
<li><p><strong>TimeEndOfStartPhase</strong> (<em>numpy.array</em>) – Annex 2 (2j) t_start_phase
For an initial period of time (t_start_phase),
the manufacturer may specify higher values
(n_min_drive_start and/or n_min_drive_up_start)
for the values n_min_drive and/or n_min_drive_up
for n_gear &gt; 2.
The input parameter here is used in combination with
MinDriveEngineSpeedGreater2ndAccelStartPhase and
MinDriveEngineSpeedGreater2ndDecelStartPhase.</p></li>
<li><p><strong>TraceTimes</strong> (<em>numpy.array</em>) – Times for each vehicle speed required re-sampled in 1Hz</p></li>
<li><p><strong>NoOfGearsFinal</strong> (<em>integer</em>) – The number of forward gears after apply the exclusion of first gear
if is necessary.</p></li>
<li><p><strong>Accelerations</strong> (<em>numpy.array</em>) – The acceleration required for the whole cycle re-sampled in 1Hz</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>MinDrives (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Samples which have acceleration values &gt;= -0.1389 m/s² ( = 0.5 (km/h)/s )
shall belong to the acceleration/constant speed phases.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.determine_gear_in_maximum_vehicle_speed">
<code class="sig-name descname"><span class="pre">determine_gear_in_maximum_vehicle_speed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PowerCurveEngineSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NdvRatios</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NoOfGearsFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurvePowers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#determine_gear_in_maximum_vehicle_speed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.determine_gear_in_maximum_vehicle_speed" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum vehicle speed is defined as the vehicle speed, at which the
available power equals the road load power caused by friction and
aerodynamics, and is usually not covered by typical traces. That is why
the calculation is based on sufficient fictive road load speeds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PowerCurveEngineSpeeds</strong> (<em>numpy.array</em>) – Contains the power curve engine speeds</p></li>
<li><p><strong>f0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The constant road load coefficient,
i.e. independent of velocity, caused by internal frictional resistances.</p></li>
<li><p><strong>f1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The linear road load coefficient,
i.e. proportional to velocity, caused by tyres rolling resistances.</p></li>
<li><p><strong>f2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The quadratic road load coefficient,
i.e. quadratical to velocity, caused by aerodynamic resistances.</p></li>
<li><p><strong>NdvRatios</strong> (<em>numpy.array</em>) – The ratio obtained by dividing the engine speed n by the vehicle speed v
for each gear i form 1 to ng after apply the exclusion of first gear if
is necessary.</p></li>
<li><p><strong>NoOfGearsFinal</strong> (<em>integer</em>) – The number of forward gears after apply the exclusion of first gear
if is necessary.</p></li>
<li><p><strong>PowerCurvePowers</strong> (<em>numpy.array</em>) – Contains the power curve powers</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>MinDrives (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>The gear that have the maximum vehicle speed</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>MaxVehicleSpeed (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>The maximum vehicle speed</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.determine_maximum_engine_speed">
<code class="sig-name descname"><span class="pre">determine_maximum_engine_speed</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">EngineSpeedLimitVMax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Max95EngineSpeedFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurveEngineSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurvePowers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RatedEnginePowerF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NdvRatios</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GearAtMaxVehicleSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequiredVehicleSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MaxVehicleSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NoOfGearsFinal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#determine_maximum_engine_speed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.determine_maximum_engine_speed" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine maximum engine speed (2g)</p>
<p>n_max1 = n_95_high</p>
<p>If n_95_high cannot be determined
because the engine speed is limited to a lower value n_lim for all gears
and the corresponding full load power is higher than 95 per cent of rated power,
n_95_high shall be set to n_lim.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>EngineSpeedLimitVMax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2, (2i) n_lim
The maximum engine speed for the purpose of limiting maximum vehicle speed.
(value 0 means unlimited vehicle speed)</p></li>
<li><p><strong>Max95EngineSpeedFinal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2g) n_max1 = n_95_high adjusted
If n_95_high cannot be determined because the engine speed is limited to
a lower value n_lim for all gears and the corresponding full load power
is higher than 95 per cent of rated power, n_95_high shall be set to n_lim.</p></li>
<li><p><strong>PowerCurveEngineSpeeds</strong> (<em>numpy.array</em>) – Contains the power curve engine speeds</p></li>
<li><p><strong>PowerCurvePowers</strong> (<em>numpy.array</em>) – Contains the power curve powers</p></li>
<li><p><strong>RatedEnginePowerF</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Contains the rated engine power corrected if is necessary</p></li>
<li><p><strong>NdvRatios</strong> (<em>numpy.array</em>) – The ratio obtained by dividing the engine speed n by the vehicle speed v
for each gear i form 1 to ng after apply the exclusion of first gear if
is necessary.</p></li>
<li><p><strong>GearAtMaxVehicleSpeed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The gear that have the maximum vehicle speed</p></li>
<li><p><strong>RequiredVehicleSpeeds</strong> (<em>numpy.array</em>) – The vehicle speed required for the whole cycle re-sampled in 1Hz</p></li>
<li><p><strong>MaxVehicleSpeed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The maximum vehicle speed</p></li>
<li><p><strong>NoOfGearsFinal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – The number of forward gears after apply the exclusion of first gear
if is necessary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>MaxEngineSpeed (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>The maximum engine speed</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>GearAtMaxVehicleSpeedFinal (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>):</dt><dd><p>Annex 2 (2i) ng_vmax
The gear in which the maximum vehicle speed is reached.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>MaxVehicleSpeedFinal (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Annex 2 (2g, 2i) v_max,vehicle
The maximum vehicle speed reachable
using the gear in which the maximum vehicle speed can be reached.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>EngineSpeedAtGearAtMaxRequiredSpeed (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>The engine speed at gear maximum required speed</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>EngineSpeedAtGearAtMaxVehicleSpeed (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>The engine speed at gear at maximum vehicle speed</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.calculate_required_powers">
<code class="sig-name descname"><span class="pre">calculate_required_powers</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RequiredVehicleSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Accelerations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VehicleTestMass</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#calculate_required_powers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.calculate_required_powers" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate required powers (3.1)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RequiredVehicleSpeeds</strong> (<em>array</em>) – The vehicle speed required for the whole cycle re-sampled in 1Hz</p></li>
<li><p><strong>Accelerations</strong> (<em>array</em>) – The acceleration required for the whole cycle re-sampled in 1Hz</p></li>
<li><p><strong>f0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The constant road load coefficient,
i.e. independent of velocity, caused by internal frictional resistances.</p></li>
<li><p><strong>f1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The linear road load coefficient,
i.e. proportional to velocity, caused by tyres rolling resistances.</p></li>
<li><p><strong>f2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The quadratic road load coefficient,
i.e. quadratical to velocity, caused by aerodynamic resistances.</p></li>
<li><p><strong>VehicleTestMass</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The test mass of the vehicle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>requiredPowersF (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Annex 2 (3.1) P_required,j
The power required to overcome driving resistance and to accelerate
for each second j of the cycle trace.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.determine_possible_gears">
<code class="sig-name descname"><span class="pre">determine_possible_gears</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">RequiredVehicleSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NdvRatios</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TraceTimesCount</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NoOfGearsFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PhaseValues</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InStandStill</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IdlingEngineSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PhaseStarts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PHASE_ACCELERATION_FROM_STANDSTILL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Accelerations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDrives</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GearAtMaxVehicleSpeedFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Max95EngineSpeedFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EngineSpeedAtGearAtMaxRequiredSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurveEngineSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InDecelerationToStandstill</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#determine_possible_gears"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.determine_possible_gears" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine possible gears based on required engine speeds (3.3)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RequiredVehicleSpeeds</strong> (<em>array</em>) – The vehicle speed required for the whole cycle re-sampled in 1Hz</p></li>
<li><p><strong>NdvRatios</strong> (<em>array</em>) – The ratio obtained by dividing the engine speed n by the vehicle speed v
for each gear i form 1 to ng after apply the exclusion of first gear if
is necessary.</p></li>
<li><p><strong>TraceTimesCount</strong> (<em>integer</em>) – The length of trace times re-sampled in 1Hz</p></li>
<li><p><strong>NoOfGearsFinal</strong> (<em>integer</em>) – The number of forward gears after apply the exclusion of first gear
if is necessary.</p></li>
<li><p><strong>PhaseValues</strong> (<em>array</em>) – Contains the points of changes phases</p></li>
<li><p><strong>InStandStill</strong> (<em>boolean array</em>) – Contains the points that are in standstill phase as a True</p></li>
<li><p><strong>IdlingEngineSpeed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2c) n_idle. The idling speed.</p></li>
<li><p><strong>PhaseStarts</strong> (<em>array</em>) – Contains the points that are start point from a phase</p></li>
<li><p><strong>PHASE_ACCELERATION_FROM_STANDSTILL</strong> (<em>integer</em>) – Acceleration phase following a standstill phase</p></li>
<li><p><strong>Accelerations</strong> (<em>array</em>) – The acceleration required for the whole cycle re-sampled in 1Hz</p></li>
<li><p><strong>MinDrives</strong> (<em>array</em>) – Samples which have acceleration values &gt;= -0.1389 m/s² ( = 0.5 (km/h)/s )
shall belong to the acceleration/constant speed phases.</p></li>
<li><p><strong>GearAtMaxVehicleSpeedFinal</strong> (<em>integer</em>) – Annex 2 (2i) ng_vmax
The gear in which the maximum vehicle speed is reached.</p></li>
<li><p><strong>Max95EngineSpeedFinal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2g) n_max1 = n_95_high adjusted
If n_95_high cannot be determined because the engine speed is limited to
a lower value n_lim for all gears and the corresponding full load power
is higher than 95 per cent of rated power, n_95_high shall be set to n_lim.</p></li>
<li><p><strong>EngineSpeedAtGearAtMaxRequiredSpeed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The engine speed at gear maximum required speed</p></li>
<li><p><strong>PowerCurveEngineSpeeds</strong> (<em>array</em>) – Contains the power curve engine speeds</p></li>
<li><p><strong>InDecelerationToStandstill</strong> (<em>boolean array</em>) – The array that contains the seconds from deceleration to standstill as a True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><dl>
<dt>RequiredEngineSpeeds (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Annex 2 (3.2) n_i,j
The engine speeds required
for each gear i from 1 to ng and
for each second j of the cycle trace.
.. note::  Note that this are the uncorrected values n_i,j</p>
<blockquote>
<div><p>i.e. without the increments required by Annex 2 (3.3)</p>
</div></blockquote>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>InitialRequiredEngineSpeeds (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>The initial engine speeds required for each gear i from 1 to ng and
for each second j of the cycle trace.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PossibleGearsByEngineSpeed (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>The possible gear that can be used for each second.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>AccelerationFromStandstillStarts (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>The phase start seconds when the phase is going to acceleration
from stand still.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ClutchDisengagedByGear (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>The clutch disengaged by each gear and each second.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ClutchUndefinedByGear (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>The clutch undefined by each gear and each second.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ClutchDisengaged (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>The clutch disengaged by each second.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ClutchUndefined (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>The clutch undefined by each second.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>AdvancedClutchDisengage (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>):</dt><dd><p>The seconds in which the advanced clutch disengaget</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.calculate_available_powers">
<code class="sig-name descname"><span class="pre">calculate_available_powers</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DefinedPowerCurveAdditionalSafetyMargins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequiredEngineSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IdlingEngineSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurveEngineSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SafetyMargin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurveASM</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurvePowers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NoOfGearsFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InitialRequiredEngineSpeeds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#calculate_available_powers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.calculate_available_powers" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate available powers (3.4)</p>
<p>Additional safety margins defined together with the power curve take precedence
over the legacy additional safety margins exponentially decaying from start to
end engine speed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DefinedPowerCurveAdditionalSafetyMargins</strong> (<em>boolean</em>) – Boolean that define if the additional save margins are present</p></li>
<li><p><strong>RequiredEngineSpeeds</strong> (<em>array</em>) – Annex 2 (3.2) n_i,j
The engine speeds required
for each gear i from 1 to ng and
for each second j of the cycle trace.
Note that this are the uncorrected values n_i,j
ie without the increments required by Annex 2 (3.3)</p></li>
<li><p><strong>IdlingEngineSpeed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2c) n_idle. The idling speed.</p></li>
<li><p><strong>PowerCurveEngineSpeeds</strong> (<em>array</em>) – Contains the power curve engine speeds</p></li>
<li><p><strong>PowerCurveASM</strong> (<em>array</em>) – Contains the power curve additional save margin</p></li>
<li><p><strong>PowerCurvePowers</strong> (<em>array</em>) – Contains the power curve powers</p></li>
<li><p><strong>NoOfGearsFinal</strong> (<em>integer</em>) – The number of forward gears after apply the exclusion of first gear
if is necessary.</p></li>
<li><p><strong>InitialRequiredEngineSpeeds</strong> (<em>array</em>) – The initial engine speeds required for each gear i from 1 to ng and
for each second j of the cycle trace.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>SafetyMargin (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Annex 2 (3.4) SM. The safety margin is accounting for the difference between the
stationary full load condition power curve and the power available
during transition conditions.
SM is set to 10 per cent.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>AvailablePowers (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Annex 2 (3.4) P_available_i,j
The power available for each gear i from 1 to ng and for each second j
of the cycle trace. Note that this power values are determined from
uncorrected values n_i,j i.e. without the engine speed increments
required by Annex 2 (3.3)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>InitialAvailablePowers (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Annex 2 (3.4) P_available_i,j (initials)
The power available for each gear i from 1 to ng and for each second j
of the cycle trace.
Note that this power values are determined from uncorrected values n_i,j
i.e. without the engine speed increments required by Annex 2 (3.3)</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.determine_possible_gears_based_available_powers">
<code class="sig-name descname"><span class="pre">determine_possible_gears_based_available_powers</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">AvailablePowers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requiredPowersF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TraceTimesCount</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NoOfGearsFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PossibleGearsByEngineSpeed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#determine_possible_gears_based_available_powers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.determine_possible_gears_based_available_powers" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine possible gears based on available powers (3.5)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>AvailablePowers</strong> (<em>array</em>) – Annex 2 (3.4) P_available_i,j
The power available for each gear i from 1 to ng and for each second j
of the cycle trace.
Note that this power values are determined from uncorrected values n_i,j
i.e. without the engine speed increments required by Annex 2 (3.3)</p></li>
<li><p><strong>requiredPowersF</strong> (<em>array</em>) – Annex 2 (3.1) P_required,j
The power required to overcome driving resistance and to accelerate
for each second j of the cycle trace.</p></li>
<li><p><strong>TraceTimesCount</strong> (<em>integer</em>) – The length of trace times re-sampled in 1Hz</p></li>
<li><p><strong>NoOfGearsFinal</strong> (<em>integer</em>) – The number of forward gears after apply the exclusion of first gear
if is necessary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>PossibleGearsByEngineSpeed (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>The possible gear that can be used for each second.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PossibleGearsByAvailablePowersWithTotalSafetyMargin (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>The possible gears by available powers with total safety margin
(following section 3.5 of Sub-Annex 2)</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.determine_initial_gears">
<code class="sig-name descname"><span class="pre">determine_initial_gears</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">InStandStill</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NoOfGearsFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PossibleGearsByEngineSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PossibleGearsByAvailablePowersWithTotalSafetyMargin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AccelerationFromStandstillStarts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PhaseEnds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PhaseValues</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PHASE_ACCELERATION_FROM_STANDSTILL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InitialRequiredEngineSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDrive1stTo2nd</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#determine_initial_gears"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.determine_initial_gears" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine initial gears</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InStandStill</strong> (<em>boolean array</em>) – Contains the points that are in standstill phase as a True</p></li>
<li><p><strong>NoOfGearsFinal</strong> (<em>integer</em>) – The number of forward gears after apply the exclusion of first gear
if is necessary.</p></li>
<li><p><strong>PossibleGearsByEngineSpeed</strong> (<em>boolean array</em>) – The possible gear that can be used for each second.</p></li>
<li><p><strong>PossibleGearsByAvailablePowersWithTotalSafetyMargin</strong> (<em>boolean array</em>) – The possible gears by available powers with total safety margin
(following section 3.5 of Sub-Annex 2)</p></li>
<li><p><strong>AccelerationFromStandstillStarts</strong> (<em>array</em>) – The phase start seconds when the phase is going to acceleration
from stand still.</p></li>
<li><p><strong>PhaseEnds</strong> (<em>array</em>) – Contains the points that are end point from a phase</p></li>
<li><p><strong>PhaseValues</strong> (<em>array</em>) – Contains the points of changes phases</p></li>
<li><p><strong>PHASE_ACCELERATION_FROM_STANDSTILL</strong> (<em>integer</em>) – Acceleration phase following a standstill phase</p></li>
<li><p><strong>InitialRequiredEngineSpeeds</strong> (<em>array</em>) – The initial engine speeds required for each gear i from 1 to ng and
for each second j of the cycle trace.</p></li>
<li><p><strong>MinDrive1stTo2nd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2ka) n_min_drive = 1.15 x n_idle for n_gear:1-&gt;2
The minimum engine speed for transitions from first to second gear.
This is the maximum of calculated value and input parameter value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>InitialGears (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>The initial gears calculated by each second</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>PossibleGears (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>The possible gears calculated by each second</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.apply_corrections">
<code class="sig-name descname"><span class="pre">apply_corrections</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">InitialGears</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PhaseValues</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PhaseStarts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PhaseEnds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PHASE_ACCELERATION_FROM_STANDSTILL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PHASE_ACCELERATION</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NoOfGearsFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PossibleGears</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InAcceleration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InConstantSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InAccelerationAnyDuration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchDisengagedByGear</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchUndefinedByGear</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PHASE_DECELERATION</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PHASE_DECELERATION_TO_STANDSTILL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TraceTimesCount</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequiredVehicleSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SuppressGear0DuringDownshifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchDisengaged</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InitialRequiredEngineSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IdlingEngineSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Phases</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InStandStill</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InDecelerationToStandstill</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InDeceleration</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#apply_corrections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.apply_corrections" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply corrections defined in section 4 of the sub-Annex 2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InitialGears</strong> (<em>array</em>) – The initial gears calculated by each second</p></li>
<li><p><strong>PhaseValues</strong> (<em>array</em>) – Contains the points of changes phases</p></li>
<li><p><strong>PhaseStarts</strong> (<em>array</em>) – Contains the points that are start point from a phase</p></li>
<li><p><strong>PhaseEnds</strong> (<em>array</em>) – Contains the points that are end point from a phase</p></li>
<li><p><strong>PHASE_ACCELERATION_FROM_STANDSTILL</strong> (<em>integer</em>) – Acceleration phase following a standstill phase</p></li>
<li><p><strong>PHASE_ACCELERATION</strong> (<em>integer</em>) – Acceleration phase</p></li>
<li><p><strong>NoOfGearsFinal</strong> (<em>integer</em>) – The number of forward gears after apply the exclusion of first gear
if is necessary.</p></li>
<li><p><strong>PossibleGears</strong> (<em>array</em>) – The possible gears calculated by each second</p></li>
<li><p><strong>InAcceleration</strong> (<em>boolean array</em>) – Contains the points that are in acceleration phase as a True</p></li>
<li><p><strong>InConstantSpeed</strong> (<em>boolean array</em>) – Contains the points that are in constant speed phase as a True</p></li>
<li><p><strong>InAccelerationAnyDuration</strong> (<em>boolean array</em>) – some gear corrections ignore the duration of acceleration phases
so save acceleration phases with any duration here</p></li>
<li><p><strong>ClutchDisengagedByGear</strong> (<em>boolean array</em>) – The clutch disengaged by each gear and each second.</p></li>
<li><p><strong>ClutchUndefinedByGear</strong> (<em>boolean array</em>) – The clutch undefined by each gear and each second.</p></li>
<li><p><strong>PHASE_DECELERATION</strong> (<em>integer</em>) – <dl class="simple">
<dt>time period of more than 2 seconds with required vehicle</dt><dd><p>speed &gt;= 1km/h and monotonically decreasing</p>
</dd>
</dl>
</p></li>
<li><p><strong>PHASE_DECELERATION_TO_STANDSTILL</strong> (<em>integer</em>) – DECELERATION phase preceding a STANDSTILL phase</p></li>
<li><p><strong>TraceTimesCount</strong> (<em>integer</em>) – The length of trace times re-sampled in 1Hz</p></li>
<li><p><strong>RequiredVehicleSpeeds</strong> (<em>array</em>) – The vehicle speed required for the whole cycle re-sampled in 1Hz</p></li>
<li><p><strong>SuppressGear0DuringDownshifts</strong> (<em>boolean</em>) – Sub-Annex 2 (4f).If a gear is used for only 1 second during a deceleration phase
it shall be replaced by gear 0 with clutch disengaged, in order to avoid too high
engine speeds. But if this is not an issue, the manufacturer may allow to use the
lower gear of the following second directly instead of gear 0 for downshifts of
up to 3 steps.</p></li>
<li><p><strong>ClutchDisengaged</strong> (<em>boolean array</em>) – The clutch disengaged by each second.</p></li>
<li><p><strong>InitialRequiredEngineSpeeds</strong> (<em>array</em>) – The initial engine speeds required for each gear i from 1 to ng and
for each second j of the cycle trace.</p></li>
<li><p><strong>IdlingEngineSpeed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2c) n_idle. The idling speed.</p></li>
<li><p><strong>Phases</strong> (<em>array</em>) – The list of phases that are used during whole cycle</p></li>
<li><p><strong>InStandStill</strong> (<em>boolean array</em>) – Contains the points that are in standstill phase as a True</p></li>
<li><p><strong>InDecelerationToStandstill</strong> (<em>boolean array</em>) – The array that contains the seconds from deceleration to standstill as a True</p></li>
<li><p><strong>InDeceleration</strong> (<em>boolean array</em>) – Contains the points that are in deceleration phase as a True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>InitialGearsFinal (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>The initial gears after apply corrections calculated by each second.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>CorrectionsCells (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Array of gear correction strings for debugging. This contains a historic
transformation of each gear during all execution and the transformation
applied.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ClutchDisengagedByGearFinal (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>The clutch disengaged by each gear and each second after apply corrections.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ClutchUndefinedByGearFinal (<code class="xref py py-class docutils literal notranslate"><span class="pre">boolean</span> <span class="pre">numpy.array</span></code>):</dt><dd><p>The clutch undefined by each gear and each second after apply corrections.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.calculate_average_gear">
<code class="sig-name descname"><span class="pre">calculate_average_gear</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">PhaseSum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InitialGearsFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequiredVehicleSpeeds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#calculate_average_gear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.calculate_average_gear" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate average gear</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>PhaseSum</strong> (<em>boolean array</em>) – The all phases that are different of standstill phase</p></li>
<li><p><strong>InitialGearsFinal</strong> (<em>array</em>) – The initial gears after apply corrections calculated by each second.</p></li>
<li><p><strong>RequiredVehicleSpeeds</strong> (<em>array</em>) – The vehicle speed required for the whole cycle re-sampled in 1Hz</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>ChecksumVxGear (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Checksum of v * gear for v &gt;= 1 km/h rounded to four places of decimal</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.interleave_clutch">
<code class="sig-name descname"><span class="pre">interleave_clutch</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TraceTimesCount</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InitialGearsFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchDisengagedByGearFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchDisengaged</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchUndefinedByGearFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchUndefined</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AutomaticClutchOperation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InDeceleration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AdvancedClutchDisengage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#interleave_clutch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.interleave_clutch" title="Permalink to this definition">¶</a></dt>
<dd><p>Interleave the clutch Sub-Annex 2 (1.5)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The prescriptions for the clutch operation shall not be applied if the clutch
is operated automatically without the need of an engagement or disengagement
of the driver.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TraceTimesCount</strong> (<em>integer</em>) – The length of trace times re-sampled in 1Hz</p></li>
<li><p><strong>InitialGearsFinal</strong> (<em>array</em>) – The initial gears after apply corrections calculated by each second.</p></li>
<li><p><strong>ClutchDisengagedByGearFinal</strong> (<em>boolean array</em>) – The clutch disengaged by each gear and each second after apply corrections.</p></li>
<li><p><strong>ClutchDisengaged</strong> (<em>boolean array</em>) – The clutch disengaged by each second.</p></li>
<li><p><strong>ClutchUndefinedByGearFinal</strong> (<em>boolean array</em>) – The clutch undefined by each gear and each second after apply corrections.</p></li>
<li><p><strong>ClutchUndefined</strong> (<em>boolean array</em>) – The clutch undefined by each second.</p></li>
<li><p><strong>AutomaticClutchOperation</strong> (<em>boolean</em>) – Sub-Annex 2 (1.5)
The prescriptions for the clutch operation shall not be applied if the clutch
is operated automatically without the need of an engagement or disengagement
of the driver.</p></li>
<li><p><strong>InDeceleration</strong> (<em>boolean array</em>) – Contains the points that are in deceleration phase as a True</p></li>
<li><p><strong>AdvancedClutchDisengage</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – The seconds in which the advanced clutch disengage</p></li>
</ul>
</dd>
<dt class="field-even">Return InitialGearsFinalAfterClutch</dt>
<dd class="field-even"><p>The initial gears after apply corrections calculated by each second and the
interleave clutch.</p>
</dd>
<dt class="field-odd">Rtype InitialGearsFinalAfterClutch</dt>
<dd class="field-odd"><p>array</p>
</dd>
<dt class="field-even">Return ClutchDisengagedFinal</dt>
<dd class="field-even"><p>The clutch disengaged by each second after apply the interleave clutch</p>
</dd>
<dt class="field-odd">Rtype ClutchDisengagedFinal</dt>
<dd class="field-odd"><p>boolean array</p>
</dd>
<dt class="field-even">Return ClutchUndefinedFinal</dt>
<dd class="field-even"><p>The clutch undefined by each second after apply the interleave clutch</p>
</dd>
<dt class="field-odd">Rtype ClutchUndefinedFinal</dt>
<dd class="field-odd"><p>boolean array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.remove_duplicate_gears">
<code class="sig-name descname"><span class="pre">remove_duplicate_gears</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">InitialGearsFinalAfterClutch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchUndefinedFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchDisengagedFinal</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#remove_duplicate_gears"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.remove_duplicate_gears" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove duplicate gears</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>InitialGearsFinalAfterClutch</strong> (<em>array</em>) – The initial gears after apply corrections calculated by each second and the
interleave clutch.</p></li>
<li><p><strong>ClutchUndefinedFinal</strong> (<em>boolean array</em>) – The clutch undefined by each second after apply the interleave clutch</p></li>
<li><p><strong>ClutchDisengagedFinal</strong> (<em>boolean array</em>) – The clutch disengaged by each second after apply the interleave clutch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>ClutchHST (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>):</dt><dd><p>Array of clutch state names as used by the Heinz Steven Tool (HST).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>GearSequenceStarts (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Array that contains the position of the gear sequence start for the different
gears.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>GearSequenceStarts (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>The name of gear to used by each gear sequence starts.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A clutch disengagement and a gear change cannot be indicated at the same time
and the clutch disengagement will therefore be indicated one second earlier.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.reduce_vehicle_speed_if_not_enough_power">
<code class="sig-name descname"><span class="pre">reduce_vehicle_speed_if_not_enough_power</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">DefinedPowerCurveAdditionalSafetyMargins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurveEngineSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurvePowers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SafetyMargin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PowerCurveASM</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IdlingEngineSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequiredEngineSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequiredVehicleSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VehicleTestMass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requiredPowersF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchDisengagedFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchUndefinedFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InitialGearsFinalAfterClutch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NoOfGearsFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AvailablePowers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NdvRatios</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#reduce_vehicle_speed_if_not_enough_power"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.reduce_vehicle_speed_if_not_enough_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce vehicle speed if not enough power is available</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>DefinedPowerCurveAdditionalSafetyMargins</strong> (<em>boolean</em>) – Boolean that define if the additional save margins are present</p></li>
<li><p><strong>PowerCurveEngineSpeeds</strong> (<em>array</em>) – Contains the power curve engine speeds</p></li>
<li><p><strong>PowerCurvePowers</strong> (<em>array</em>) – Contains the power curve powers</p></li>
<li><p><strong>SafetyMargin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (3.4) SM
The safety margin is accounting for the difference between the
stationary full load condition power curve and the power available
during transition conditions.
SM is set to 10 per cent.</p></li>
<li><p><strong>PowerCurveASM</strong> (<em>array</em>) – Contains the power curve additional save margin</p></li>
<li><p><strong>IdlingEngineSpeed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2c) n_idle. The idling speed.</p></li>
<li><p><strong>RequiredEngineSpeeds</strong> (<em>array</em>) – Annex 2 (3.2) n_i,j
The engine speeds required
for each gear i from 1 to ng and
for each second j of the cycle trace.
Note that this are the uncorrected values n_i,j
ie without the increments required by Annex 2 (3.3)</p></li>
<li><p><strong>RequiredVehicleSpeeds</strong> (<em>array</em>) – The vehicle speed required for the whole cycle re-sampled in 1Hz</p></li>
<li><p><strong>f0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The constant road load coefficient,
i.e. independent of velocity, caused by internal frictional resistances.</p></li>
<li><p><strong>f1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The linear road load coefficient,
i.e. proportional to velocity, caused by tyres rolling resistances.</p></li>
<li><p><strong>f2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The quadratic road load coefficient,
i.e. quadratical to velocity, caused by aerodynamic resistances.</p></li>
<li><p><strong>VehicleTestMass</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The test mass of the vehicle.</p></li>
<li><p><strong>requiredPowersF</strong> (<em>array</em>) – Annex 2 (3.1) P_required,j
The power required to overcome driving resistance and to accelerate
for each second j of the cycle trace.</p></li>
<li><p><strong>ClutchDisengagedFinal</strong> (<em>boolean array</em>) – The clutch disengaged by each second after apply the interleave clutch</p></li>
<li><p><strong>ClutchUndefinedFinal</strong> (<em>boolean array</em>) – The clutch undefined by each second after apply the interleave clutch</p></li>
<li><p><strong>InitialGearsFinalAfterClutch</strong> (<em>array</em>) – The initial gears after apply corrections calculated by each second and the
interleave clutch.</p></li>
<li><p><strong>NoOfGearsFinal</strong> (<em>integer</em>) – The number of forward gears after apply the exclusion of first gear
if is necessary.</p></li>
<li><p><strong>AvailablePowers</strong> (<em>array</em>) – Annex 2 (3.4) P_available_i,j
The power available for each gear i from 1 to ng and for each second j
of the cycle trace.
Note that this power values are determined from uncorrected values n_i,j
i.e. without the engine speed increments required by Annex 2 (3.3)</p></li>
<li><p><strong>NdvRatios</strong> (<em>array</em>) – The ratio obtained by dividing the engine speed n by the vehicle speed v
for each gear i form 1 to ng after apply the exclusion of first gear if
is necessary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>AvailablePowersFinal (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.array</span></code>):</dt><dd><p>Annex 2 (3.4) P_available_i,j
The power available for each gear i from 1 to ng and for each second j
of the cycle trace, after check vehicle speed.
Note that this power values are determined from uncorrected values n_i,j
i.e. without the engine speed increments required by Annex 2 (3.3)</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="gearshift.core.model.calculateShiftpointsNdvFullPC.generate_gears">
<code class="sig-name descname"><span class="pre">generate_gears</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TraceTimes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GearSequenceStarts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GearNames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AverageGear</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Max95EngineSpeedFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequiredVehicleSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requiredPowersF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RequiredEngineSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PossibleGearsByEngineSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">AvailablePowersFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InitialRequiredEngineSpeeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InitialAvailablePowers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FullPowerCurve</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EngineSpeedAtGearAtMaxRequiredSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EngineSpeedAtGearAtMaxVehicleSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MaxEngineSpeed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MaxVehicleSpeedFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GearAtMaxVehicleSpeedFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDrive1st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDrive1stTo2nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDrive2ndDecel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDrive2nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MinDriveGreater2nd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">InitialGearsFinalAfterClutch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchDisengagedFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchUndefinedFinal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ClutchHST</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CorrectionsCells</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ChecksumVxGear</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/gearshift/core/model/calculateShiftpointsNdvFullPC.html#generate_gears"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gearshift.core.model.calculateShiftpointsNdvFullPC.generate_gears" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign outputs in the final dictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TraceTimes</strong> (<em>array</em>) – Times for each vehicle speed required re-sampled in 1Hz</p></li>
<li><p><strong>GearSequenceStarts</strong> (<em>array</em>) – Array that contains the position of the gear sequence start for the different
gears.</p></li>
<li><p><strong>GearNames</strong> (<em>array</em>) – The name of gear to used by each gear sequence starts.</p></li>
<li><p><strong>AverageGear</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (5) average gear
In order to enable the assessment of the correctness of the calculation,
the average gear for v &gt;= 1 km/h, rounded to four places of decimal,
shall be calculated and recorded.</p></li>
<li><p><strong>Max95EngineSpeedFinal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2g) n_max1 = n_95_high adjusted
If n_95_high cannot be determined because the engine speed is limited to
a lower value n_lim for all gears and the corresponding full load power
is higher than 95 per cent of rated power, n_95_high shall be set to n_lim.</p></li>
<li><p><strong>RequiredVehicleSpeeds</strong> (<em>array</em>) – The vehicle speed required for the whole cycle re-sampled in 1Hz</p></li>
<li><p><strong>requiredPowersF</strong> (<em>array</em>) – Annex 2 (3.1) P_required,j
The power required to overcome driving resistance and to accelerate
for each second j of the cycle trace.</p></li>
<li><p><strong>RequiredEngineSpeeds</strong> (<em>array</em>) – Annex 2 (3.2) n_i,j
The engine speeds required
for each gear i from 1 to ng and
for each second j of the cycle trace.
Note that this are the uncorrected values n_i,j
ie without the increments required by Annex 2 (3.3)</p></li>
<li><p><strong>PossibleGearsByEngineSpeed</strong> (<em>boolean array</em>) – The possible gear that can be used for each second.</p></li>
<li><p><strong>AvailablePowersFinal</strong> (<em>array</em>) – Annex 2 (3.4) P_available_i,j
The power available for each gear i from 1 to ng and for each second j
of the cycle trace, after check vehicle speed.
Note that this power values are determined from uncorrected values n_i,j
i.e. without the engine speed increments required by Annex 2 (3.3)</p></li>
<li><p><strong>InitialRequiredEngineSpeeds</strong> (<em>array</em>) – The initial engine speeds required for each gear i from 1 to ng and
for each second j of the cycle trace.</p></li>
<li><p><strong>InitialAvailablePowers</strong> (<em>array</em>) – Annex 2 (3.4) P_available_i,j (initials)
The power available for each gear i from 1 to ng and for each second j
of the cycle trace.
Note that this power values are determined from uncorrected values n_i,j
i.e. without the engine speed increments required by Annex 2 (3.3)</p></li>
<li><p><strong>FullPowerCurve</strong> (<em>array</em>) – Annex 2 (2h) and (3.4) n ==&gt; P_wot(n), ASM
The full load power curve over the engine speed range.</p></li>
<li><p><strong>EngineSpeedAtGearAtMaxRequiredSpeed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The engine speed at gear maximum required speed</p></li>
<li><p><strong>EngineSpeedAtGearAtMaxVehicleSpeed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The engine speed at gear at maximum vehicle speed</p></li>
<li><p><strong>MaxEngineSpeed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – The maximum engine speed</p></li>
<li><p><strong>MaxVehicleSpeedFinal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2g, 2i) v_max,vehicle
The maximum vehicle speed reachable
using the gear in which the maximum vehicle speed can be reached.</p></li>
<li><p><strong>GearAtMaxVehicleSpeedFinal</strong> (<em>integer</em>) – Annex 2 (2i) ng_vmax
The gear in which the maximum vehicle speed is reached.</p></li>
<li><p><strong>MinDrive1st</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2k) n_min_drive = n_idle for n_gear:1
The minimum engine speed when the vehicle is in motion.
This is the maximum of calculated value and input parameter value.</p></li>
<li><p><strong>MinDrive1stTo2nd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2ka) n_min_drive = 1.15 x n_idle for n_gear:1-&gt;2
The minimum engine speed for transitions from first to second gear.
This is the maximum of calculated value and input parameter value.</p></li>
<li><p><strong>MinDrive2ndDecel</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2kb) n_min_drive = n_idle for n_gear:2
The minimum engine speed for decelerations to standstill in second gear.
This is the maximum of calculated value and input parameter value.</p></li>
<li><p><strong>MinDrive2nd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2kc) n_min_drive = 0.9 x n_idle for n_gear:2
The minimum engine speed for all other driving conditions in second gear.
This is the maximum of calculated value and input parameter value.</p></li>
<li><p><strong>MinDriveGreater2nd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Annex 2 (2k) n_min_drive = n_idle + 0.125 × ( n_rated - n_idle ) for n_gear:3..
This value shall be referred to as n_min_drive_set.
The minimum engine speed for all driving conditions in gears greater than 2.
This is the maximum of calculated value and input parameter value.</p></li>
<li><p><strong>InitialGearsFinalAfterClutch</strong> (<em>array</em>) – The initial gears after apply corrections calculated by each second and the
interleave clutch.</p></li>
<li><p><strong>ClutchDisengagedFinal</strong> (<em>boolean array</em>) – The clutch disengaged by each second after apply the interleave clutch</p></li>
<li><p><strong>ClutchUndefinedFinal</strong> (<em>boolean array</em>) – The clutch undefined by each second after apply the interleave clutch</p></li>
<li><p><strong>ClutchHST</strong> (<em>array</em>) – Array of clutch state names as used by the Heinz Steven Tool (HST).</p></li>
<li><p><strong>CorrectionsCells</strong> (<em>array</em>) – Array of gear correction strings for debugging. This contains a historic
transformation of each gear during all execution and the transformation
applied.</p></li>
<li><p><strong>ChecksumVxGear</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) – Checksum of v * gear for v &gt;= 1 km/h rounded to four places of decimal.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>shift_points (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>):</dt><dd><p>Dictionary that contains the all input parameters with the expected
output format.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A clutch disengagement and a gear change cannot be indicated at the same time
and the clutch disengagement will therefore be indicated one second earlier.</p>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2013-2020, European Commission (JRC).

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>